/**
 * Kiubi API - forms.js
 * 
 * Copyright 2013 Troll d'idees
 */
var createForm=function(a,b){b=b||$("<form>");var d=null;$.each(a,function(a,c){c.id="captcha"==c.name?"captcha":"field_"+a;if("fieldset"==c.type)d=$("<fieldset>").appendTo(b),$("<legend>").html(this.label).appendTo(d);else{var f=createFormElement(c),g=$("<label>",{html:c.label+(c.required?"&nbsp;*":""),"for":c.id});!1!==f&&("hidden"!=f.attr("type")&&g.appendTo(d||b),c.value&&f.val(c.value),f.appendTo(d||b))}});return b},createFormElement=function(a){switch(a.type){case "text":case "date":case "datetime":case "email":case "hidden":case "lettres":case "password":return $("<input>",{id:a.id,type:a.type,placeholder:a.help,name:a.name,"class":"textfield "+a.type});case "chiffres":return $("<input>",{id:a.id,type:"number",placeholder:a.help,name:a.name,"class":"textfield "+a.type});case "upload":return $("<input>",{id:a.id,type:"file",name:a.name,"class":a.type});case "textarea":return $("<textarea>",{id:a.id,placeholder:a.help,name:a.name});case "select":var b=$("<select>",{id:a.id,name:a.name});$.each(a.options,function(){$("<option>").attr({value:this.value}).html(this.label).appendTo(b)});return b;case "departements":return b=$("<select>",{id:a.id,name:a.name}),kiubi.get("geo/countries/73/departements").done(function(a,e){$.each(e,function(){$("<option>").attr({value:this.code}).html(this.code+" - "+this.name).appendTo(b)})}),b;case "regions":return b=$("<select>",{id:a.id,name:a.name}),kiubi.get("geo/countries/73/regions").done(function(a,e){$.each(e,function(){$("<option>").attr({value:this.id}).html(this.name).appendTo(b)})}),b;case "pays":return b=$("<select>",{id:a.id,name:a.name}),kiubi.get("geo/countries").done(function(a,e){$.each(e,function(){$("<option>").attr({value:this.id}).html(this.name).appendTo(b)})}),b;case "radio":case "civilite":case "checkbox":return b=$("<div>",{id:a.id,"class":a.type}),$.each(a.options,function(){var d=$("<input>",{type:"civilite"==a.type?"radio":a.type,name:a.name,value:this.value});$("<label>").append(d).append(this.label).appendTo(b)}),b;default:return!1}};
